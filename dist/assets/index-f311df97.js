import{V as g,_ as b,u as v,I as P,a as w,c as a,n as S}from"./index-6878f845.js";import{C as T,E as O}from"./error-circle-filled-1c5b2372.js";var j=["size"];function h(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),s.push.apply(s,t)}return s}function y(e){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?h(Object(s),!0).forEach(function(t){w(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var C={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.3 13.7a1 1 0 00.7.3h10a1 1 0 001-1V8.5h-1V13H3V3h4.5V2H3a1 1 0 00-1 1v10c0 .27.1.52.3.7z",fillOpacity:.9}},{tag:"path",attrs:{fill:"currentColor",d:"M9 3V2h4.5c.28 0 .5.22.5.5V7h-1V3.7L8.7 8 8 7.3 12.3 3H9z",fillOpacity:.9}}]},u=g.extend({name:"JumpIcon",functional:!0,props:{size:{type:String},onClick:{type:Function}},render:function(r,s){var t=s.props,n=s.data,o=t.size,i=b(t,j),l=v(o),c=l.className,p=l.style,d=y(y({},i||{}),{},{id:"jump",icon:C,staticClass:c,style:p});return n.props=d,r(P,n)}}),R=["size"];function m(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),s.push.apply(s,t)}return s}function f(e){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?m(Object(s),!0).forEach(function(t){w(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):m(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var L={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.23 11.89l2.12-2.12.71.7-2.12 2.13A2.5 2.5 0 013.4 9.06l2.13-2.12.7.7-2.12 2.13a1.5 1.5 0 002.12 2.12zM10.47 9.06l-.7-.7 2.12-2.13a1.5 1.5 0 10-2.12-2.12L7.65 6.23l-.71-.7L9.06 3.4a2.5 2.5 0 013.54 3.54l-2.13 2.12z",fillOpacity:.9}},{tag:"path",attrs:{fill:"currentColor",d:"M9.06 6.23L6.23 9.06l.71.7 2.83-2.82-.7-.7z",fillOpacity:.9}}]},k=g.extend({name:"LinkIcon",functional:!0,props:{size:{type:String},onClick:{type:Function}},render:function(r,s){var t=s.props,n=s.data,o=t.size,i=b(t,R),l=v(o),c=l.className,p=l.style,d=f(f({},i||{}),{},{id:"link",icon:L,staticClass:c,style:p});return n.props=d,r(P,n)}});const $={components:{LinkIcon:k,JumpIcon:u},data(){const e=this.$createElement;return{data:[],size:"medium",tableLayout:!1,stripe:!0,bordered:!0,hover:!1,showHeader:!0,selectedRowKeys:[1],renderSuffixIcon:()=>e(u),columns:[{colKey:"row-select",type:"multiple",width:50},{colKey:"id",title:"#",width:"50",ellipsis:!0},{colKey:"url",title:"URL",width:"150",cell:(r,{row:s})=>r("t-link",{attrs:{theme:"primary",hover:"color",href:"//"+s.url,target:"_blank"}},[s.url,r(u,{slot:"suffixIcon"})])},{colKey:"ip_address",title:"IP 地址",width:"150",ellipsis:!0},{colKey:"port_number",title:"端口号",width:"100"},{colKey:"service_name",title:"服务名称",width:"200",ellipsis:!0},{colKey:"protocol",title:"协议",width:"100"},{colKey:"state",title:"状态",width:"150",cell:(r,{row:s})=>{const n={open:{label:"开放",theme:"success",icon:r(T)},closed:{label:"关闭",theme:"danger",icon:r(O)}}[s.state.toLowerCase()]||{label:s.state,theme:"default"};return r("t-tag",{attrs:{shape:"round",theme:n.theme,variant:"light-outline"}},[n.icon,n.label])}},{colKey:"http_code",title:"HTTP状态码",width:"100",ellipsis:!0},{colKey:"http_title",title:"HTTP标题",width:"200",ellipsis:!0},{colKey:"https_code",title:"HTTPS状态码",width:"100",ellipsis:!0},{colKey:"https_title",title:"HTTP标题",width:"200",ellipsis:!0},{colKey:"operation",title:"操作",width:120,cell:(r,{row:s})=>r("t-button",{attrs:{theme:"danger",ghost:!0},on:{click:()=>this.deleteResult(s.id)}},["删除"])}],pagination:{current:1,pageSize:50,total:0,showJumper:!0}}},methods:{clickLink(e){console.log("触发",e)},fetchResults(e){const r={task_id:e};this.$request.post("/api/port_scanner/task_status",JSON.stringify(r),{headers:{"Content-Type":"application/json"}}).then(s=>{const t=s.data.task_result.ports,n=t.length;n>0?(a.success(`端口扫描结果已获取，共${n}条数据。`),this.data=t,this.pagination.total=n):a.info("没有获取到端口扫描结果。")}).catch(s=>{console.log(s),a.error("获取失败")})},deleteResult(e){this.$request.delete(`/api/port_scanner/ports/${e}/delete`,{headers:{"Content-Type":"application/json"}}).then(()=>{a.success("结果删除成功"),this.data=this.data.filter(r=>r.id!==e),this.pagination.total=this.data.length}).catch(r=>{console.error(r),a.error("删除失败")})},rehandleSelectChange(e,{selectedRowData:r}){this.selectedRowKeys=e},startHTTPPathScan(){const e=this.selectedRowKeys.map(t=>this.data.find(n=>n.id===t)).filter(t=>t&&t.ip_address&&t.port_number).map(t=>`http://${t.ip_address}:${t.port_number}/FUZZ`),s={urls:[...new Set(e)],wordlist:"./wordlist/top7000.txt"};this.$request.post("/api/path_scanner/scan",s,{headers:{"Content-Type":"application/json"}}).then(()=>{a.success("路径扫描任务已启动")}).catch(t=>{console.error(t),a.error("启动路径扫描任务失败")})},startHTTPSPathScan(){const e=this.selectedRowKeys.map(t=>this.data.find(n=>n.id===t)).filter(t=>t&&t.ip_address&&t.port_number).map(t=>`https://${t.ip_address}:${t.port_number}/FUZZ`),s={urls:[...new Set(e)],wordlist:"./wordlist/top7000.txt"};this.$request.post("/api/path_scanner/scan",s,{headers:{"Content-Type":"application/json"}}).then(()=>{a.success("路径扫描任务已启动")}).catch(t=>{console.error(t),a.error("启动路径扫描任务失败")})},startHTTPPathSimpleScan(){const e=this.selectedRowKeys.map(t=>this.data.find(n=>n.id===t)).filter(t=>t&&t.ip_address&&t.port_number).map(t=>`http://${t.ip_address}:${t.port_number}/FUZZ`),s={urls:[...new Set(e)],delay:"0.5",wordlist:"./wordlist/default_wordlist.txt"};this.$request.post("/api/path_scanner/scan",s,{headers:{"Content-Type":"application/json"}}).then(()=>{a.success("路径扫描任务已启动")}).catch(t=>{console.error(t),a.error("启动路径扫描任务失败")})},startHTTPSPathSimpleScan(){const e=this.selectedRowKeys.map(t=>this.data.find(n=>n.id===t)).filter(t=>t&&t.ip_address&&t.port_number).map(t=>`https://${t.ip_address}:${t.port_number}/FUZZ`),s={urls:[...new Set(e)],delay:"0.5",wordlist:"./wordlist/default_wordlist.txt"};this.$request.post("/api/path_scanner/scan",s,{headers:{"Content-Type":"application/json"}}).then(()=>{a.success("路径扫描任务已启动")}).catch(t=>{console.error(t),a.error("启动路径扫描任务失败")})},onPageChange(e,r){this.pagination.defaultCurrent||(this.pagination.current=e.current,this.pagination.pageSize=e.pageSize)},exportToCSV(){const e=[],r=["ID","IP 地址","端口号","服务名称","协议","状态","是否支持HTTP","是否支持HTTPS"];e.push(r.join(",")),this.data.forEach(o=>{const i=[o.id,`"${o.ip_address}"`,o.port_number,`"${o.service_name}"`,o.protocol,o.state,o.is_http?"支持":"不支持",o.is_https?"支持":"不支持"];e.push(i.join(","))});const s=e.join(`
`),t=new Blob([s],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download="port-scan-results.csv",n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},mounted(){const e=this.$route.query.task_id;this.fetchResults(e)}};var z=function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("t-space",{attrs:{direction:"vertical"}},[[s("t-space",[s("t-button",{attrs:{theme:"primary"},on:{click:e.startHTTPPathScan}},[e._v("对选定的项目启动 HTTP路径 扫描")]),s("t-button",{attrs:{theme:"primary"},on:{click:e.startHTTPSPathScan}},[e._v("对选定的项目启动 HTTPS路径 扫描")]),s("t-button",{attrs:{theme:"primary"},on:{click:e.startHTTPPathSimpleScan}},[e._v("对选定的项目启动 简单HTTP路径 扫描")]),s("t-button",{attrs:{theme:"primary"},on:{click:e.startHTTPPathSimpleScan}},[e._v("对选定的项目启动 简单HTTPS路径 扫描")]),s("t-button",{attrs:{theme:"primary"},on:{click:e.exportToCSV}},[e._v("导出CSV")])],1)],s("t-table",{attrs:{rowKey:"id",data:e.data,columns:e.columns,stripe:e.stripe,bordered:e.bordered,hover:e.hover,size:e.size,"table-layout":e.tableLayout?"auto":"fixed",pagination:e.pagination,showHeader:e.showHeader,"selected-row-keys":e.selectedRowKeys,cellEmptyContent:"-",resizable:""},on:{"select-change":e.rehandleSelectChange,"page-change":e.onPageChange}})],2)},H=[];const _={};var K=S($,z,H,!1,q,null,null,null);function q(e){for(let r in _)this[r]=_[r]}const D=function(){return K.exports}();export{D as default};
