- # 网络扫描数据模型文档

  ## 1. 概述

  本文档描述了一个用于网络扫描和信息收集的数据模型。该模型设计用于存储和组织与域名和 IP 地址相关的各种扫描结果，包括端口信息、服务识别、Web路径和指纹等。

  ## 2. 核心概念

  - **结果 (Result)**: 表示一次完整的扫描结果。
  - **目标 (Target)**: 表示一个扫描目标，可以是子域名或 IP 地址。
  - **子域名 (Subdomain)**: 表示一个子域名及其相关的端口信息。
  - **IP 地址 (IPAddress)**: 表示一个 IP 地址及其相关的端口信息。
  - **端口 (Port)**: 表示开放端口及其相关信息。
  - **指纹 (Fingerprint)**: 表示在端口上识别到的服务或应用的特征。
  - **路径 (Path)**: 表示在 Web 服务中发现的 URL 路径。

  ## 3. 数据结构

  ### 3.1 Result

  ```go
  type Result struct {
  	ID      primitive.ObjectID `json:"id" bson:"_id,omitempty"`
  	Targets []*Target          `json:"Targets"`
  }
  ```

  - 包含所有扫描目标的列表。

  ### 3.2 Target

  ```go
  type Target struct {
  	ID          primitive.ObjectID `json:"id" bson:"_id,omitempty"`
  	Identifier  string             `json:"Identifier"`            // 子域名或IP地址
  	Type        string             `json:"Type"`                  // "Subdomain" 或 "IP"
  	Subdomains  []*Subdomain       `json:"Subdomains,omitempty"`  // 子域名列表
  	IPAddresses []*IPAddress       `json:"IPAddresses,omitempty"` // IP地址列表
  	LastScan    time.Time          `json:"LastScan"`
  }
  ```

  - `Identifier`: 目标的唯一标识符（子域名或 IP 地址）。
  - `Type`: 指示目标类型（"Subdomain" 或 "IP"）。
  - `Subdomains`: 子域名列表，仅用于 "Subdomain" 类型。
  - `IPAddresses`: IP 地址列表，仅用于 "IP" 类型。
  - `LastScan`: 最后一次扫描的时间戳。

  ### 3.3 Subdomain

  ```go
  type Subdomain struct {
  	ID    primitive.ObjectID `json:"id" bson:"_id,omitempty"`
  	Name  string             `json:"Name"`
  	Ports []*Port            `json:"Ports,omitempty"` // 扫描到的端口信息
  }
  ```

  - `Name`: 子域名名称。
  - `Ports`: 与子域名相关的端口列表。

  ### 3.4 IPAddress

  ```go
  type IPAddress struct {
  	ID      primitive.ObjectID `json:"id" bson:"_id,omitempty"`
  	Address net.IP             `json:"Address"`
  	Ports   []*Port            `json:"Ports,omitempty"` // 扫描到的端口信息
  }
  ```

  - `Address`: IP 地址。
  - `Ports`: 与 IP 地址相关的端口列表。

  ### 3.5 Port

  ```go
  type Port struct {
  	ID           primitive.ObjectID `json:"id" bson:"_id,omitempty"`
  	Number       int                `json:"Number"`
  	Protocol     string             `json:"Protocol"`
  	Service      string             `json:"Service"`
  	Banner       string             `json:"Banner"`
  	Fingerprints []*Fingerprint     `json:"Fingerprints,omitempty"` // 指纹信息
  	Paths        []*Path            `json:"Paths,omitempty"`        // URL路径信息
  }
  ```

  - `Number`: 端口号。
  - `Protocol`: 使用的协议（如 "tcp" 或 "udp"）。
  - `Service`: 识别到的服务名称。
  - `Banner`: 服务返回的 banner 信息。
  - `Fingerprints`: 在此端口上识别到的指纹列表。
  - `Paths`: 对于 Web 服务，存储发现的 URL 路径。

  ### 3.6 Fingerprint

  ```go
  type Fingerprint struct {
  	ID      primitive.ObjectID `json:"id" bson:"_id,omitempty"`
  	Type    string             `json:"Type"`
  	Name    string             `json:"Name"`
  	Version string             `json:"Version"`
  }
  ```

  - `Type`: 指纹类型（如 "OS"、"WebServer"、"Framework" 等）。
  - `Name`: 识别到的软件或服务名称。
  - `Version`: 版本信息（如果可用）。

  ### 3.7 Path

  ```go
  type Path struct {
  	ID          primitive.ObjectID `json:"id" bson:"_id,omitempty"`
  	URL         string             `json:"URL"`
  	StatusCode  int                `json:"StatusCode"`
  	ContentType string             `json:"ContentType"`
  	Size        int64              `json:"Size"`
  }
  ```

  - `URL`: 发现的 URL 路径。
  - `StatusCode`: HTTP 响应状态码。
  - `ContentType`: 响应的内容类型。
  - `Size`: 响应的大小（字节）。

  ## 4. 使用注意事项

  - 确保每个数据集都有唯一标识，以便于管理和关联。
  - 在处理大规模扫描时，请注意内存使用，可能需要实现分批处理或数据库存储机制。
  - 模型支持 JSON 序列化，便于数据存储和传输。
